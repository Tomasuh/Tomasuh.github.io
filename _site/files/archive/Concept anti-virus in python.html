<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>Concept anti-virus in python | TomsonSec</title>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok2v=1613a3a185/"},atok:"c2f92801b93be329f53894911606aec8",petok:"a34bf3021462eb909929c70a3165bb2ecd888a74-1419606319-1800",zone:"tomsonsec.com",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok2v=919620257c/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/cloudflare.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_13ca4c6376f" onload="CloudFlare.__cfjs_block_13ca4c6376f_load()" onerror="CloudFlare.__cfjs_block_13ca4c6376f_error()" onreadystatechange="CloudFlare.__cfjs_block_13ca4c6376f_readystatechange()" type="text/javascript" src="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/rocket.js"></script>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://tomsonsec.com/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://tomsonsec.com/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Feed" href="http://tomsonsec.com/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Comments Feed" href="http://tomsonsec.com/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Concept anti-virus in python Comments Feed" href="http://tomsonsec.com/index.php/concept-anti-virus-in-python/feed/">
<link rel="stylesheet" id="twentytwelve-fonts-css" href="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-style-css" href="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/A.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://tomsonsec.com/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery.js,qver=1.11.1.pagespeed.jm.z9hb-Gxqf6.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery-migrate.min.js,qver=1.2.1.pagespeed.jm.mhpNjdU8Wl.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://tomsonsec.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://tomsonsec.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Clamav database downloader" href="http://tomsonsec.com/index.php/clamav-database-downloader/">
<link rel="next" title="Safe installers?" href="http://tomsonsec.com/index.php/safe-installers/">
<meta name="generator" content="WordPress 4.1">
<link rel="canonical" href="http://tomsonsec.com/index.php/concept-anti-virus-in-python/">
<link rel="shortlink" href="http://tomsonsec.com/?p=68">
 
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shCore.js.pagespeed.jm.ErSeI76fhQ.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(2(){1 h=5;h.I=2(){2 n(c,a){4(1 d=0;d<c.9;d++)i[c[d]]=a}2 o(c){1 a=r.H("J"),d=3;a.K=c;a.M="L/t";a.G="t";a.u=a.v=2(){6(!d&&(!8.7||8.7=="F"||8.7=="z")){d=q;e[c]=q;a:{4(1 p y e)6(e[p]==3)B a;j&&5.C(k)}a.u=a.v=x;a.D.O(a)}};r.N.R(a)}1 f=Q,l=h.P(),i={},e={},j=3,k=x,b;5.T=2(c){k=c;j=q};4(b=0;b<f.9;b++){1 m=f[b].w?f[b]:f[b].S(/\\s+/),g=m.w();n(m,g)}4(b=0;b<l.9;b++)6(g=i[l[b].E.A]){e[g]=3;o(g)}}})();',56,56,'|var|function|false|for|SyntaxHighlighter|if|readyState|this|length|||||||||||||||||true|document||javascript|onload|onreadystatechange|pop|null|in|complete|brush|break|highlight|parentNode|params|loaded|language|createElement|autoloader|script|src|text|type|body|removeChild|findElements|arguments|appendChild|split|all'.split('|'),0,{}))
//]]></script>
<link type="text/css" rel="stylesheet" href="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/A_002.css">
 
<style type="text/css" id="custom-background-css">body.custom-background{background-color:#fff;background-image:url(http://tomsonsec.com/wp-content/uploads/2013/11/tweed_,402X.png.pagespeed.ce.ovGQxspg7h.png);background-repeat:repeat;background-position:top left;background-attachment:fixed}</style>
</head>
<body class="single single-post postid-68 single-format-standard custom-background full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<hgroup>
<h1 class="site-title"><a href="http://tomsonsec.com/" title="TomsonSec" rel="home">TomsonSec</a></h1>
<h2 class="site-description">Computer security and more</h2>
</hgroup>
<nav id="site-navigation" class="main-navigation" role="navigation">
<h3 class="menu-toggle">Menu</h3>
<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
<div class="nav-menu"><ul><li><a href="http://tomsonsec.com/">Home</a></li><li class="page_item page-item-54"><a href="http://tomsonsec.com/index.php/54-2/">About</a></li><li class="page_item page-item-377"><a href="http://tomsonsec.com/index.php/practical-reverse-engineering/">Practical Reverse Engineering – solutions</a></li></ul></div>
</nav> 
</header> 
<div id="main" class="wrapper">
<div id="primary" class="site-content">
<div id="content" role="main">
<article id="post-68" class="post-68 post type-post status-publish format-standard hentry category-clamav category-programming category-security tag-anti-virus tag-av tag-clamav-database tag-malware tag-pefile tag-psutil tag-python">
<header class="entry-header">
<h1 class="entry-title">Concept anti-virus in python</h1>
<div class="comments-link">
<a href="http://tomsonsec.com/index.php/concept-anti-virus-in-python/#respond" title="Comment on Concept anti-virus in python"><span class="leave-reply">Leave a reply</span></a> </div> 
</header> 
<div class="entry-content">
<p>So writing an anti-virus in python, good idea? For performance, no, 
but for the fun and learning more about identifying malware sure!</p>
<p>For those of you who haven’t explored the python libraries <a title="pefile" href="http://code.google.com/p/pefile/" target="_blank">pefile</a>&nbsp;and <a title="psutil" href="http://code.google.com/p/psutil/" target="_blank">psutil</a>&nbsp;I
 strongly suggest you to do so. They’re both fantastic with great 
functionalities. And as they both have a great role to play in the AV I 
will start of with showing some of their good to know functions.<br>
Pefile can be used as the names suggests in reading the pe-format, and 
as a beginner in the pe world, I found pefile to be a great tool to 
explore files with.</p>
<p>Lets have a basic example (see end of post for pe-format structure):</p>
<div><div id="highlighter_650769" class="syntaxhighlighter  py"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">import</code> <code class="py plain">pefile</code></div><div class="line number2 index1 alt1"><code class="py plain">pe </code><code class="py keyword">=</code> <code class="py plain">pefile.PE(</code><code class="py string">"readme.exe"</code><code class="py plain">)</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py keyword">for</code> <code class="py plain">dataSections </code><code class="py keyword">in</code> <code class="py plain">pe.sections:</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">dataSections.name</code></div></div></td></tr></tbody></table></div></div>
<p>Or why not:</p>
<div><div id="highlighter_394944" class="syntaxhighlighter  py"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">import</code> <code class="py plain">pefile</code></div><div class="line number2 index1 alt1"><code class="py plain">pe </code><code class="py keyword">=</code> <code class="py plain">pefile.PE(</code><code class="py string">"readme.exe"</code><code class="py plain">)</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py keyword">for</code> <code class="py plain">dataSections </code><code class="py keyword">in</code> <code class="py plain">pe.sections:</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">dataSections.SizeOfRawData</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">dataSections.get_hash_md5()</code></div></div></td></tr></tbody></table></div></div>
<p>As it happends the main.mdb file with signatures from Clamav are 
precisly of this pattern, the size of the current datasection and the 
md5 hash of the content, size:md5:malware name.<br>
See now how simple stuff are with pefile?</p>
<p>Lets have a peek at psutil, a bit more common library and as a python
 developer (if you are) I’m suprised if you haven’t touched it before.</p>
<p>Basic example for printing out the names of new processes:</p>
<div><div id="highlighter_667743" class="syntaxhighlighter  py"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">import</code> <code class="py plain">psutil,time</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="py comments">#Returns all active processes as pids in a list.</code></div><div class="line number4 index3 alt1"><code class="py keyword">def</code> <code class="py plain">count ():</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">psutil.get_pid_list()</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="py comments">#Checks if all the elements in list2 exists in list1. Those who don't returned as a list</code></div><div class="line number8 index7 alt1"><code class="py comments">#Example: class.diff([1,2,3],[2,3,4]) returns [4]</code></div><div class="line number9 index8 alt2"><code class="py keyword">def</code> <code class="py plain">diff (list1,list2):</code></div><div class="line number10 index9 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">newAdded </code><code class="py keyword">=</code> <code class="py plain">[]</code></div><div class="line number11 index10 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">for</code> <code class="py plain">elem </code><code class="py keyword">in</code> <code class="py plain">list2:</code></div><div class="line number12 index11 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">if</code> <code class="py plain">elem </code><code class="py keyword">in</code> <code class="py plain">list1:</code></div><div class="line number13 index12 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">continue</code></div><div class="line number14 index13 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">else</code><code class="py plain">:</code></div><div class="line number15 index14 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">newAdded.append(elem)</code></div><div class="line number16 index15 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">newAdded</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="py comments">#Prints the name of all processes in given list of pids.</code></div><div class="line number19 index18 alt2"><code class="py keyword">def</code> <code class="py plain">processName(pids):</code></div><div class="line number20 index19 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">for</code> <code class="py plain">elem </code><code class="py keyword">in</code> <code class="py plain">pids:</code></div><div class="line number21 index20 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">try</code><code class="py plain">:</code></div><div class="line number22 index21 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">psutil.Process(elem).name</code></div><div class="line number23 index22 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">except</code> <code class="py plain">psutil.NoSuchProcess:</code></div><div class="line number24 index23 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">pass</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="py comments">#Looping infinite, and if list of pids from the loop before is different</code></div><div class="line number27 index26 alt2"><code class="py comments">#to the current list we got some new processes to examine.</code></div><div class="line number28 index27 alt1"><code class="py keyword">def</code> <code class="py plain">check():</code></div><div class="line number29 index28 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">beginning</code><code class="py keyword">=</code><code class="py plain">count()</code></div><div class="line number30 index29 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">while</code> <code class="py color1">True</code><code class="py plain">:</code></div><div class="line number31 index30 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">try</code><code class="py plain">:</code></div><div class="line number32 index31 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">if</code> <code class="py plain">beginning !</code><code class="py keyword">=</code> <code class="py plain">count():</code></div><div class="line number33 index32 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">processName (diff(beginning,count()))</code></div><div class="line number34 index33 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">beginning</code><code class="py keyword">=</code><code class="py plain">count() </code></div><div class="line number35 index34 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">except</code> <code class="py plain">psutil.AccessDenied:</code></div><div class="line number36 index35 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">continue</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">time.sleep(</code><code class="py value">0.5</code><code class="py plain">)</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="py plain">check()</code></div></div></td></tr></tbody></table></div></div>
<p>These examples are just a showoff of the&nbsp;possibilities with them
 and I suggest you to read their corresponding documentation for more 
information. Although the ones used in the AV will probably make sense 
just by looking at the name of them.</p>
<p>So lets start with the actual AV, first I listed the main functionalities I was looking for:</p>
<ul>
<li>Active scanning of started processes</li>
<li>Action in case of malware (kill/ suspend/ nothing)</li>
<li>Runmode (Configuration for prefered action in case of found malware)</li>
<li>Database where scanned processes are saved</li>
<li>Extract good to know stuff with pefile</li>
<li>Make use of ClamAV signature database</li>
</ul>
<p>The AV consists of :</p>
<p><strong><span style="color: #800000;">superior.py</span></strong><br>
This is the “main” file, from where we scan for new processes and in 
case of new ones, scan for malware, if malware run the action in line 
with the user mode.<br>
Chill: No action, just print out infected file and malware name.<br>
Normal: Kill the malware found.<br>
Bitch: Kill all processes that dosn’t exist in the database.<br>
Active run mode has the value 0, inactive 1.</p>
<p><strong><span style="color: #800000;">pefile2.py</span></strong><br>
As the name propose this file contains all the pefile functions, such as:</p>
<ul>
<li>peSectionSize</li>
<li>osVersion</li>
<li>loadedDlls</li>
</ul>
<p><strong><span style="color: #800000;">database.py</span></strong><br>
Contains all database functions (in sqlite3) such as:</p>
<ul>
<li>insertFile</li>
<li>absProcesspathExist</li>
</ul>
<p>Here is the database layout in ER format generated by Navicat (great program):</p>
<p><a style="color: #0f3647;" href="http://tomsonsec.com/wp-content/uploads/2013/11/restructure.png"><img class="alignnone  wp-image-96" alt="restructure" src="Concept%20anti-virus%20in%20python%20%7C%20TomsonSec_files/421x229xrestructure.jpg" height="229" width="421"></a></p>
<p><strong><span style="color: #800000;">psfunc.py</span></strong><br>
psutil functions to be used such as:</p>
<ul>
<li>kill</li>
<li>suspend</li>
<li>&nbsp;absProcessPath</li>
</ul>
<p><span style="color: #800000;"><strong>searchsig.py</strong></span><br>
Searches main.mdb in clamav folder for given signatures.</p>
<h2>Setup</h2>
<p>First you need to download the database for Clamav, I’ve made a script for this which you can get here:&nbsp;<a title="Clamav database downloader" href="http://tomsonsec.com/?p=38" target="_blank">http://tomsonsec.com/?p=38</a><br>
Run the script in the same folder as your gonna run the AV.</p>
<p>Now its just to download the antivirus files at my <a title="git" href="https://github.com/Tomasuh/Anti-virus-in-python" target="_blank">github</a>&nbsp;profile and start superior.py and hopefully it should run all good!</p>
<h2>&nbsp;Conclusion</h2>
<p>Writing an anti-virus in python with the right tools can be extremely
 simple. While it may not be the way to go for writing a professional 
one it’s still a very effective learning process with lots of fun for 
the one just getting started out. Now it’s time to learn more about 
win32 api and pe format and next time maybe we do it in C! (probably 
not)</p>
<address>Good to know:<br>
The AV currently only supports the format found in main.mdb so no real 
world use is recommended. Hopefully I’ll write functions for supporting 
the other signatures but that day is not today.<br>
There are no support for processes with same path and name but with different content.</address>
</div> 
<footer class="entry-meta">
This entry was posted in <a href="http://tomsonsec.com/index.php/category/clamav/" rel="category tag">ClamAV</a>, <a href="http://tomsonsec.com/index.php/category/programming/" rel="category tag">programming</a>, <a href="http://tomsonsec.com/index.php/category/security/" rel="category tag">security</a> and tagged <a href="http://tomsonsec.com/index.php/tag/anti-virus/" rel="tag">anti-virus</a>, <a href="http://tomsonsec.com/index.php/tag/av/" rel="tag">AV</a>, <a href="http://tomsonsec.com/index.php/tag/clamav-database/" rel="tag">Clamav database</a>, <a href="http://tomsonsec.com/index.php/tag/malware/" rel="tag">malware</a>, <a href="http://tomsonsec.com/index.php/tag/pefile/" rel="tag">pefile</a>, <a href="http://tomsonsec.com/index.php/tag/psutil/" rel="tag">psutil</a>, <a href="http://tomsonsec.com/index.php/tag/python/" rel="tag">python</a> on <a href="http://tomsonsec.com/index.php/concept-anti-virus-in-python/" title="1:13 pm" rel="bookmark"><time class="entry-date" datetime="2013-11-23T13:13:29+00:00">November 23, 2013</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://tomsonsec.com/index.php/author/tomasuh/" title="View all posts by Tomasuh" rel="author">Tomasuh</a></span></span>. </footer> 
</article> 
<nav class="nav-single">
<h3 class="assistive-text">Post navigation</h3>
<span class="nav-previous"><a href="http://tomsonsec.com/index.php/clamav-database-downloader/" rel="prev"><span class="meta-nav">←</span> Clamav database downloader</a></span>
<span class="nav-next"><a href="http://tomsonsec.com/index.php/safe-installers/" rel="next">Safe installers? <span class="meta-nav">→</span></a></span>
</nav> 
<div id="comments" class="comments-area">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://tomsonsec.com/index.php/concept-anti-virus-in-python/#respond" style="display:none;">Cancel reply</a></small></h3>
<form action="http://tomsonsec.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p> <p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" aria-describedby="email-notes" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" type="text"></p>
<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true"></textarea></p> <p class="form-allowed-tags" id="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes: <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del 
datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; 
&lt;strong&gt; </code></p> <p class="form-submit">
<input name="submit" id="submit" class="submit" value="Post Comment" type="submit">
<input name="comment_post_ID" value="68" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p>
<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="7f43d5ae01" type="hidden"></p><p style="display: none;"></p> <input id="ak_js" name="ak_js" value="1419606319581" type="hidden"></form>
</div> 
</div> 
</div> 
</div> 
</div> 
<footer id="colophon" role="contentinfo">
<div class="site-info">
<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
</div> 
</footer> 
</div> 
 
<script data-rocketoptimized="true" type="text/rocketscript">SyntaxHighlighter.autoloader('applescript			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAppleScript.js','actionscript3 as3		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAS3.js','bash shell				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushBash.js','coldfusion cf			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushColdFusion.js','cpp c					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCpp.js','c# c-sharp csharp		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCSharp.js','css					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCss.js','delphi pascal pas		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDelphi.js','diff patch			    http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDiff.js','erl erlang				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushErlang.js','groovy					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushGroovy.js','java					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJava.js','jfx javafx				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJavaFX.js','js jscript javascript	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJScript.js','perl pl				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPerl.js','php					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPhp.js','text plain				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPlain.js','powershell ps          http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPowerShell.js','py python				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPython.js','ruby rails ror rb		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushRuby.js','sass scss              http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSass.js','scala					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushScala.js','sql					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSql.js','vb vbnet				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushVb.js','xml xhtml xslt html	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushXml.js');SyntaxHighlighter.defaults['toolbar']=false;SyntaxHighlighter.defaults['tab-size']=4;SyntaxHighlighter.all();</script>
 
<script data-rocketoptimized="true" type="text/rocketscript">function showhide_toggle(a,b,c,d){var e=jQuery("#"+a+"-link-"+b),f=jQuery("#"+a+"-content-"+b);a=jQuery("#"+a+"-toggle-"+b);e.toggleClass("sh-show sh-hide");f.toggleClass("sh-show sh-hide").toggle();a.text()===c?a.text(d):a.text(c)};</script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var ak_js=document.getElementById("ak_js");if(!ak_js){ak_js=document.createElement('input');ak_js.setAttribute('id','ak_js');ak_js.setAttribute('name','ak_js');ak_js.setAttribute('type','hidden');}
else{ak_js.parentNode.removeChild(ak_js);}
ak_js.setAttribute('value',(new Date()).getTime());var commentForm=document.getElementById('commentform');if(commentForm){commentForm.appendChild(ak_js);}
else{var replyRowContainer=document.getElementById('replyrow');if(replyRowContainer){var children=replyRowContainer.getElementsByTagName('td');if(children.length>0){children[0].appendChild(ak_js);}}}
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var addComment={moveForm:function(a,b,c,d){var e,f=this,g=f.I(a),h=f.I(c),i=f.I("cancel-comment-reply-link"),j=f.I("comment_parent"),k=f.I("comment_post_ID");if(g&&h&&i&&j){f.respondId=c,d=d||!1,f.I("wp-temp-form-div")||(e=document.createElement("div"),e.id="wp-temp-form-div",e.style.display="none",h.parentNode.insertBefore(e,h)),g.parentNode.insertBefore(h,g.nextSibling),k&&d&&(k.value=d),j.value=b,i.style.display="",i.onclick=function(){var a=addComment,b=a.I("wp-temp-form-div"),c=a.I(a.respondId);if(b&&c)return a.I("comment_parent").value="0",b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),this.style.display="none",this.onclick=null,!1};try{f.I("comment").focus()}catch(l){}return!1}},I:function(a){return document.getElementById(a)}};
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
(function(){var nav=document.getElementById('site-navigation'),button,menu;if(!nav)
return;button=nav.getElementsByTagName('h3')[0];menu=nav.getElementsByTagName('ul')[0];if(!button)
return;if(!menu||!menu.childNodes.length){button.style.display='none';return;}
button.onclick=function(){if(-1==menu.className.indexOf('nav-menu'))
menu.className='nav-menu';if(-1!=button.className.indexOf('toggled-on')){button.className=button.className.replace(' toggled-on','');menu.className=menu.className.replace(' toggled-on','');}else{button.className+=' toggled-on';menu.className+=' toggled-on';}};})();
//]]></script>

</body></html>