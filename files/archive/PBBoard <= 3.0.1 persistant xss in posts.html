<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>PBBoard | TomsonSec</title>
<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok2v=1613a3a185/"},atok:"c2f92801b93be329f53894911606aec8",petok:"795fd0887ee74024df41eecfe9dcb56a5b94bfcc-1419623902-1800",zone:"tomsonsec.com",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok2v=919620257c/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="PBBoard%20%3C=%203.0.1%20persistant%20xss%20in%20posts%7C%20TomsonSec_files/cloudflare.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_bab21e8968" onload="CloudFlare.__cfjs_block_bab21e8968_load()" onerror="CloudFlare.__cfjs_block_bab21e8968_error()" onreadystatechange="CloudFlare.__cfjs_block_bab21e8968_readystatechange()" type="text/javascript" src="PBBoard%20%3C=%203.0.1%20persistant%20xss%20in%20posts%7C%20TomsonSec_files/rocket.js"></script>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://tomsonsec.com/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://tomsonsec.com/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Feed" href="http://tomsonsec.com/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » Comments Feed" href="http://tomsonsec.com/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="TomsonSec » PBBoard  Comments Feed" href="http://tomsonsec.com/index.php/pbboard-2/feed/">
<link rel="stylesheet" id="twentytwelve-fonts-css" href="PBBoard%20%3C=%203.0.1%20persistant%20xss%20in%20posts%7C%20TomsonSec_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-style-css" href="PBBoard%20%3C=%203.0.1%20persistant%20xss%20in%20posts%7C%20TomsonSec_files/A.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://tomsonsec.com/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery.js,qver=1.11.1.pagespeed.jm.z9hb-Gxqf6.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-includes/js/jquery/jquery-migrate.min.js,qver=1.2.1.pagespeed.jm.mhpNjdU8Wl.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://tomsonsec.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://tomsonsec.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="PBBoard " href="http://tomsonsec.com/index.php/pbboard/">
<link rel="next" title="Reversing Belkin N750 DB router #1" href="http://tomsonsec.com/index.php/reversing-belkin-n750-db-router/">
<meta name="generator" content="WordPress 4.1">
<link rel="canonical" href="http://tomsonsec.com/index.php/pbboard-2/">
<link rel="shortlink" href="http://tomsonsec.com/?p=307">
 
<script data-rocketoptimized="true" type="text/rocketscript" data-rocketsrc="http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shCore.js.pagespeed.jm.ErSeI76fhQ.js"></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(2(){1 h=5;h.I=2(){2 n(c,a){4(1 d=0;d<c.9;d++)i[c[d]]=a}2 o(c){1 a=r.H("J"),d=3;a.K=c;a.M="L/t";a.G="t";a.u=a.v=2(){6(!d&&(!8.7||8.7=="F"||8.7=="z")){d=q;e[c]=q;a:{4(1 p y e)6(e[p]==3)B a;j&&5.C(k)}a.u=a.v=x;a.D.O(a)}};r.N.R(a)}1 f=Q,l=h.P(),i={},e={},j=3,k=x,b;5.T=2(c){k=c;j=q};4(b=0;b<f.9;b++){1 m=f[b].w?f[b]:f[b].S(/\\s+/),g=m.w();n(m,g)}4(b=0;b<l.9;b++)6(g=i[l[b].E.A]){e[g]=3;o(g)}}})();',56,56,'|var|function|false|for|SyntaxHighlighter|if|readyState|this|length|||||||||||||||||true|document||javascript|onload|onreadystatechange|pop|null|in|complete|brush|break|highlight|parentNode|params|loaded|language|createElement|autoloader|script|src|text|type|body|removeChild|findElements|arguments|appendChild|split|all'.split('|'),0,{}))
//]]></script>
<link type="text/css" rel="stylesheet" href="PBBoard%20%3C=%203.0.1%20persistant%20xss%20in%20posts%7C%20TomsonSec_files/A_002.css">
 
<style type="text/css" id="custom-background-css">body.custom-background{background-color:#fff;background-image:url(http://tomsonsec.com/wp-content/uploads/2013/11/tweed_,402X.png.pagespeed.ce.ovGQxspg7h.png);background-repeat:repeat;background-position:top left;background-attachment:fixed}</style>
</head>
<body class="single single-post postid-307 single-format-standard custom-background full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<hgroup>
<h1 class="site-title"><a href="http://tomsonsec.com/" title="TomsonSec" rel="home">TomsonSec</a></h1>
<h2 class="site-description">Computer security and more</h2>
</hgroup>
<nav id="site-navigation" class="main-navigation" role="navigation">
<h3 class="menu-toggle">Menu</h3>
<a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>
<div class="nav-menu"><ul><li><a href="http://tomsonsec.com/">Home</a></li><li class="page_item page-item-54"><a href="http://tomsonsec.com/index.php/54-2/">About</a></li><li class="page_item page-item-377"><a href="http://tomsonsec.com/index.php/practical-reverse-engineering/">Practical Reverse Engineering – solutions</a></li></ul></div>
</nav> 
</header> 
<div id="main" class="wrapper">
<div id="primary" class="site-content">
<div id="content" role="main">
<article id="post-307" class="post-307 post type-post status-publish format-standard hentry category-pentest category-php tag-pbboard tag-pentest tag-security tag-xss">
<header class="entry-header">
<h1 class="entry-title">PBBoard &lt;= 3.0.1 persistant xss in posts</h1>
										<div class="comments-link">
					<a href="http://tomsonsec.com/index.php/pbboard-2/#respond" title="Comment on PBBoard "><span class="leave-reply">Leave a reply</span></a>				</div><!-- .comments-link -->
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>As you can read in my previous post I’ve taken a bit of a look in 
to PBBoard and I’ve discovered an interesting post format for signatures
 when you post in a thread. Example:</p>
<div><div id="highlighter_332043" class="syntaxhighlighter  html"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number2 index1 alt1"><code class="html plain">guest_name=fisk</code></div><div class="line number3 index2 alt2"><code class="html plain">code=9d49a</code></div><div class="line number4 index3 alt1"><code class="html plain">title=asdasddas</code></div><div class="line number5 index4 alt2"><code class="html plain">text=hello&lt;</code><code class="html keyword">img</code> <code class="html color1">title</code><code class="html plain">=</code><code class="html string">"biggrin2"</code> <code class="html color1">src</code><code class="html plain">=</code><code class="html string">"look/images/smiles/biggrin2.gif"</code> <code class="html color1">alt</code><code class="html plain">=</code><code class="html string">"biggrin2"</code> <code class="html color1">height</code><code class="html plain">=</code><code class="html string">"20"</code> <code class="html color1">width</code><code class="html plain">=</code><code class="html string">"20"</code><code class="html plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="html plain">icon=look/images/icons/i1.gif</code></div><div class="line number7 index6 alt2"><code class="html plain">count=24</code></div><div class="line number8 index7 alt1"><code class="html plain">insert=Submit quick reply</code></div></div></td></tr></tbody></table></div></div>
<p>So an img tag straight given by the client, great!</p>
<p>Though it seems like he does some kind of filtering as for example if
 I give the onerror attribute it wont be saved into the img tag.<br>
And in &lt;script&gt;, &lt; are html encoded.</p>
<p>But, for example &lt;body onload=alert(123)&gt; will be executed, so 
he’s somewhat selective about which tags and attributes to filter?</p>
<p>Possible solution:</p>
<p>Stop accepting html tags and attributes in posts, only accept values to attributes after safely filtered them.</p>
<p>Terrible ideas:<br>
As the software use’s no verification in the change of email and 
password we could create a javascript bot to totally take over visiting 
users on the forum, and spread on in to other topics. A realistic 
scenario.</p>
<p>Disclosure time line:<br>
25/05 2014 vendor notified<br>
11/06 2014 vulnerability released (no vendor response)</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="http://tomsonsec.com/index.php/category/pentest/" rel="category tag">pentest</a>, <a href="http://tomsonsec.com/index.php/category/php/" rel="category tag">php</a> and tagged <a href="http://tomsonsec.com/index.php/tag/pbboard/" rel="tag">pbboard</a>, <a href="http://tomsonsec.com/index.php/tag/pentest/" rel="tag">pentest</a>, <a href="http://tomsonsec.com/index.php/tag/security/" rel="tag">security</a>, <a href="http://tomsonsec.com/index.php/tag/xss/" rel="tag">xss</a> on <a href="http://tomsonsec.com/index.php/pbboard-2/" title="7:02 am" rel="bookmark"><time class="entry-date" datetime="2014-06-11T07:02:34+00:00">June 11, 2014</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://tomsonsec.com/index.php/author/tomasuh/" title="View all posts by Tomasuh" rel="author">Tomasuh</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

				<nav class="nav-single">
					<h3 class="assistive-text">Post navigation</h3>
					<span class="nav-previous"><a href="http://tomsonsec.com/index.php/pbboard/" rel="prev"><span class="meta-nav">←</span> PBBoard &lt;= 3.0.1 user cookie hash disclousere</a></span>
					<span class="nav-next"><a href="http://tomsonsec.com/index.php/reversing-belkin-n750-db-router/" rel="next">Reversing Belkin N750 DB router #1 <span class="meta-nav">→</span></a></span>
				</nav><!-- .nav-single -->

				
<div id="comments" class="comments-area">

	
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://tomsonsec.com/index.php/pbboard-2/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://tomsonsec.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" aria-describedby="email-notes" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" type="text"></p>
												<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true"></textarea></p>						<p class="form-allowed-tags" id="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del 
datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; 
&lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" id="submit" class="submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="307" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="4d4b47ab53" type="hidden"></p><p style="display: none;"></p>					<input id="ak_js" name="ak_js" value="1419623902737" type="hidden"></form>
							</div><!-- #respond -->
			
</div><!-- #comments .comments-area -->
			
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	
<!-- START: Syntax Highlighter ComPress -->
<script data-rocketoptimized="true" type="text/rocketscript">SyntaxHighlighter.autoloader('applescript			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAppleScript.js','actionscript3 as3		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushAS3.js','bash shell				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushBash.js','coldfusion cf			http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushColdFusion.js','cpp c					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCpp.js','c# c-sharp csharp		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCSharp.js','css					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushCss.js','delphi pascal pas		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDelphi.js','diff patch			    http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushDiff.js','erl erlang				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushErlang.js','groovy					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushGroovy.js','java					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJava.js','jfx javafx				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJavaFX.js','js jscript javascript	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushJScript.js','perl pl				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPerl.js','php					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPhp.js','text plain				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPlain.js','powershell ps          http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPowerShell.js','py python				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushPython.js','ruby rails ror rb		http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushRuby.js','sass scss              http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSass.js','scala					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushScala.js','sql					http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushSql.js','vb vbnet				http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushVb.js','xml xhtml xslt html	http://tomsonsec.com/wp-content/plugins/syntax-highlighter-compress/scripts/shBrushXml.js');SyntaxHighlighter.defaults['toolbar']=false;SyntaxHighlighter.defaults['tab-size']=4;SyntaxHighlighter.all();</script>
<!-- END: Syntax Highlighter ComPress -->

				<script data-rocketoptimized="true" type="text/rocketscript">function showhide_toggle(a,b,c,d){var e=jQuery("#"+a+"-link-"+b),f=jQuery("#"+a+"-content-"+b);a=jQuery("#"+a+"-toggle-"+b);e.toggleClass("sh-show sh-hide");f.toggleClass("sh-show sh-hide").toggle();a.text()===c?a.text(d):a.text(c)};</script>
	<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var ak_js=document.getElementById("ak_js");if(!ak_js){ak_js=document.createElement('input');ak_js.setAttribute('id','ak_js');ak_js.setAttribute('name','ak_js');ak_js.setAttribute('type','hidden');}
else{ak_js.parentNode.removeChild(ak_js);}
ak_js.setAttribute('value',(new Date()).getTime());var commentForm=document.getElementById('commentform');if(commentForm){commentForm.appendChild(ak_js);}
else{var replyRowContainer=document.getElementById('replyrow');if(replyRowContainer){var children=replyRowContainer.getElementsByTagName('td');if(children.length>0){children[0].appendChild(ak_js);}}}
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
var addComment={moveForm:function(a,b,c,d){var e,f=this,g=f.I(a),h=f.I(c),i=f.I("cancel-comment-reply-link"),j=f.I("comment_parent"),k=f.I("comment_post_ID");if(g&&h&&i&&j){f.respondId=c,d=d||!1,f.I("wp-temp-form-div")||(e=document.createElement("div"),e.id="wp-temp-form-div",e.style.display="none",h.parentNode.insertBefore(e,h)),g.parentNode.insertBefore(h,g.nextSibling),k&&d&&(k.value=d),j.value=b,i.style.display="",i.onclick=function(){var a=addComment,b=a.I("wp-temp-form-div"),c=a.I(a.respondId);if(b&&c)return a.I("comment_parent").value="0",b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b),this.style.display="none",this.onclick=null,!1};try{f.I("comment").focus()}catch(l){}return!1}},I:function(a){return document.getElementById(a)}};
//]]></script>
<script data-rocketoptimized="true" type="text/rocketscript">//<![CDATA[
(function(){var nav=document.getElementById('site-navigation'),button,menu;if(!nav)
return;button=nav.getElementsByTagName('h3')[0];menu=nav.getElementsByTagName('ul')[0];if(!button)
return;if(!menu||!menu.childNodes.length){button.style.display='none';return;}
button.onclick=function(){if(-1==menu.className.indexOf('nav-menu'))
menu.className='nav-menu';if(-1!=button.className.indexOf('toggled-on')){button.className=button.className.replace(' toggled-on','');menu.className=menu.className.replace(' toggled-on','');}else{button.className+=' toggled-on';menu.className+=' toggled-on';}};})();
//]]></script>

</body></html>